# AutoForm
*Note: this readme was generated on 30.01.2023 16:51:55 +00:00 using README_template.ls*



---
## Description <a name="bb80fcd6-f412-4898-a73f-fdc5353b8431"></a>


AutoForm is a model-driven UI control (input component) generation tool for .Net. 
Its aim is to decouple UI controls from each other.

Similar to dependency injection, using controls managed by AutoForm forces decoupling from implementations, 
so callers need only know the model for which they require a control.


---
## Table of Contents <a name="689bce63-ad1d-4beb-8b2b-ee6398bc46fd"></a>

1. [Description](#bb80fcd6-f412-4898-a73f-fdc5353b8431)

2. [Table of Contents](#689bce63-ad1d-4beb-8b2b-ee6398bc46fd)

3. [Versioning](#63810087-f374-4663-b1f4-e9668d3652f8)

4. [Features](#3d6ce4b6-0279-49ac-a932-13fa37934922)

	4.1. [Attribute-based model discovery](#eabd7843-ef43-4422-95ce-bba4f4f0c63e)

	4.2. [Debug json generator](#d7ecc0a9-b52e-4b04-a064-fdf81ec5c75b)

	4.3. [Blazor component generator](#98630836-6f65-492c-9391-3be2d688e4f7)

5. [Installation](#10f79cba-d49c-4381-ad7c-9b43b4e273c0)

6. [How To Use](#df24d9b0-d5fb-4317-89bb-2c6a5f2749ca)

	6.1. [A Note on Attributes](#03719944-4b29-4581-afe9-5d664667a3ed)

	6.2. [Creating Models](#5c68bb4d-1dae-44b3-8539-1990f7ce3b9f)

	6.3. [Creating Templates](#dc8d6411-f6d8-45e2-8835-d3df36567be3)

	6.4. [Creating Controls](#bd850c9e-8ef1-4a0e-9cab-28c3859aa8c6)

	6.5. [First Results](#dbff0d1c-a9e9-44f8-ad14-5982ce4c3018)

	6.6. [Complex Models](#7028f0e0-7f29-43ae-a590-e8694852f927)

	6.7. [Complex Models Result](#9e3aa67a-6423-47e4-a347-67c6a086f187)

	6.8. [Submodels](#bc589980-4078-4287-ae2e-4e3c69bea409)

	6.9. [Submodels Result](#1b5c2d91-9cfd-4b61-9b8e-3abeefb39bc5)

7. [Planned Features](#7421ddb1-24e5-4737-a977-ee6149f2b05f)

8. [License](#c3ec6b49-3ec4-4287-bfc0-102a6f23d215)

9. [Contributors](#dbdf899c-da5e-4a1c-bb23-c52884230777)



---
## Versioning <a name="63810087-f374-4663-b1f4-e9668d3652f8"></a>


AutoForm uses [Semantic Versioning 2.0.0](https://semver.org/).


---
## Features <a name="3d6ce4b6-0279-49ac-a932-13fa37934922"></a>

* Attribute-based model discovery
* Debug json generator
* Blazor component generator


---
### Attribute-based model discovery <a name="eabd7843-ef43-4422-95ce-bba4f4f0c63e"></a>


TODO: describe attribute discovery here.


---
### Debug json generator <a name="d7ecc0a9-b52e-4b04-a064-fdf81ec5c75b"></a>


TODO: describe json generator here


---
### Blazor component generator <a name="98630836-6f65-492c-9391-3be2d688e4f7"></a>


TODO: describe blazor generator here


---
## Installation <a name="10f79cba-d49c-4381-ad7c-9b43b4e273c0"></a>

Currently, there are multiple packages published for generating code based on models:

* For model discovery, an attribute collection is provided in the AutoForm.Attributes package.
* For debug purposes, a json generator is provided in the AutoForm.Json.Analysis package.
* For use in Blazor, a blazor component generator is provided in the AutoForm.Blazor.Analysis package.
* For accessing controls generated by AutoForm.Blazor.Analysis, an entry point control and other default controls and templates are provided in the AutoForm.Blazor package.

In order to use the generators, models have to be annotated using the attributes found in AutoForm.Attributes. Since the generators rely on code semantics in order to discover models, you may implement your own attributes using the same namespace and attribute names as in AutoForm.Attributes. This is currently not reccomended, as the underlying processes are not hardened against faulty attribute declarations.

<details>
<summary>Installing AutoForm.Attributes</summary>

Nuget Gallery: https://www.nuget.org/packages/RhoMicro.AutoForm.Attributes

Package Manager: `Install-Package RhoMicro.AutoForm.Attributes -Version 3.0.0`

.Net CLI: `dotnet add package RhoMicro.AutoForm.Attributes --version 3.0.0`
</details>



<details>
<summary>Installing AutoForm.Blazor</summary>

Nuget Gallery: https://www.nuget.org/packages/RhoMicro.AutoForm.Blazor

Package Manager: `Install-Package RhoMicro.AutoForm.Blazor -Version 2.1.0`

.Net CLI: `dotnet add package RhoMicro.AutoForm.Blazor --version 2.1.0`
</details>



<details>
<summary>Installing AutoForm.Blazor.Analysis</summary>

Nuget Gallery: https://www.nuget.org/packages/RhoMicro.AutoForm.Blazor.Analysis

Package Manager: `Install-Package RhoMicro.AutoForm.Blazor.Analysis -Version 3.0.1`

.Net CLI: `dotnet add package RhoMicro.AutoForm.Blazor.Analysis --version 3.0.1`
</details>



<details>
<summary>Installing AutoForm.Json.Analysis</summary>

Nuget Gallery: https://www.nuget.org/packages/RhoMicro.AutoForm.Json.Analysis

Package Manager: `Install-Package RhoMicro.AutoForm.Json.Analysis -Version 3.0.1`

.Net CLI: `dotnet add package RhoMicro.AutoForm.Json.Analysis --version 3.0.1`
</details>



---
## How To Use <a name="df24d9b0-d5fb-4317-89bb-2c6a5f2749ca"></a>


*The following samples use the provided blazor generator.*


---
### A Note on Attributes <a name="03719944-4b29-4581-afe9-5d664667a3ed"></a>


While templates and controls used for the blazor generator are required to provide an `Attributes` property, generated controls will ignore any attributes passed to them.
Default controls found in `AutoForm.Blazor.Controls` will honor attributes passed via the `Attributes` property.


---
### Creating Models <a name="5c68bb4d-1dae-44b3-8539-1990f7ce3b9f"></a>



Register a model by annotating at least one of its properties with the `ModelPropertyAttribute`:

```cs
using AutoForm.Attributes;

namespace TestApp.Models;

public class MyModel
{
	[ModelProperty]
	public String? Name {
		get;
		set;
	}
}

```

*Source: [TestApp.Models.MyModel](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Models/MyModel.cs)*



Access the generated control using the `AutoControl`:

```razor
@page "/"
@using TestApp.Models

<AutoForm.Blazor.AutoControl @bind-Value="Model" />

<span>
	@(nameof(MyModel.Name)) : @(Model.Name)
</span>

@code {
	private MyModel Model { get; set; } = new MyModel();
}
```

*Source: [TestApp.Pages.Index.razor](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Pages/Index.razor)*


Note that default controls provided by `AutoForm.Blazor`, found in `AutoForm.Blazor.Controls`, will bind to the `oninput` event. 
This means that when using these controls, models will be updated with every keystroke instead of when a control loses focus, as is default.


---
### Creating Templates <a name="dc8d6411-f6d8-45e2-8835-d3df36567be3"></a>



Templates may be created in order surround a control with another component. They must semantically implement the following interface:

```cs
using Microsoft.AspNetCore.Components;

namespace AutoForm.Blazor.Templates.Abstractions
{
	public abstract class TemplateBase<TModel> : ComponentBase
	{
		[Parameter]
		public virtual TModel? Value { get; set; }
		[Parameter]
		public virtual IEnumerable<KeyValuePair<String, Object>>? Attributes { get; set; }
		[Parameter]
		public virtual RenderFragment? ChildContent { get; set; }
	}
}

```

*Source: [AutoForm.Blazor.Templates.Abstractions.TemplateBase](https://github.com/PaulBraetz/AutoForm/blob/master/AutoForm.Blazor/Templates/Abstractions/TemplateBase.cs)*

Here, TModel is the model type whose control this template should be applied to. These properties enable the template to access the controls attributes as well as the models current value. The control will be passed to `ChildContent`.

*Note that templates must only provide properties that are semantically identical to those found in `TemplateBase`, as well as inherit from `ComponentBase`.*

For uniform bootstrap template styling, a primitive base template may be created like so:

```razor
@typeparam TModel
@inherits AutoForm.Blazor.Templates.Abstractions.TemplateBase<TModel>

<div class="input-group mb-3">
	<span class="input-group-text" >@Text</span>
	@ChildContent
</div>

@code{
	private Object Text => Attributes?.SingleOrDefault(kvp => kvp.Key == "label").Value ??
								"Enter Value:";
}
```

*Source: [TestApp.Templates.MyTemplate](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Templates/MyTemplate.razor)*





```cs
using AutoForm.Blazor.Templates.Abstractions;

namespace TestApp.Templates;

public abstract partial class MyTemplate<TModel> : TemplateBase<TModel>
{
}

```

*Source: [TestApp.Templates.MyTemplate](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Templates/MyTemplate.razor.cs)*



Implement a template for controls whose model is of type `System.String` or that control the `MyModel.Name` property:

```cs
using AutoForm.Attributes;

using TestApp.Models;

namespace TestApp.Templates;

[DefaultTemplate(typeof(String))]
[DefaultTemplate(typeof(MyModel), nameof(MyModel.Name))]
public sealed class StringTemplate : MyTemplate<String>
{
}

```

*Source: [TestApp.Templates.MyModelNameTemplate](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Templates/StringTemplate.cs)*



---
### Creating Controls <a name="bd850c9e-8ef1-4a0e-9cab-28c3859aa8c6"></a>



Controls may be declared in order to override default or generated controls. They must semantically implement the following interface:

```cs
using Microsoft.AspNetCore.Components;

namespace AutoForm.Blazor.Controls.Abstractions
{
	public abstract class ControlBase<TModel> : ComponentBase
	{
		[Parameter]
		public virtual TModel? Value { get; set; }

		[Parameter]
		public virtual EventCallback<TModel> ValueChanged { get; set; }

		[Parameter]
		public virtual IEnumerable<KeyValuePair<String, Object>>? Attributes { get; set; }
	}
}

```

*Source: [AutoForm.Blazor.Controls.Abstractions.ControlBase](https://github.com/PaulBraetz/AutoForm/blob/master/AutoForm.Blazor/Controls/Abstractions/ControlBase.cs)*

Here, TModel is the model type this control should be applied to.

*Note that controls must only provide properties that are semantically identical to those found in `ControlBase`, as well as inherit from `ComponentBase`.*

Implement a control for models of type `System.String` or subcontrol for `MyModel.Name`:

```razor
@inherits AutoForm.Blazor.Controls.Abstractions.ControlBase<String>

<input class="form-control" type="text" @attributes="Attributes" value="@Value" @onchange="v=>ValueChanged.InvokeAsync(Value = v.Value?.ToString())" />
```

*Source: [TestApp.Controls.MyModelNameControl](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Controls/StringControl.razor)*





```cs
using AutoForm.Attributes;

using TestApp.Models;

namespace TestApp.Controls;

[DefaultControl(typeof(String))]
[DefaultControl(typeof(MyModel), nameof(MyModel.Name))]
public partial class StringControl : AutoForm.Blazor.Controls.Abstractions.ControlBase<String>
{
}

```

*Source: [TestApp.Controls.MyModelNameControl](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Controls/StringControl.razor.cs)*



---
### First Results <a name="dbff0d1c-a9e9-44f8-ad14-5982ce4c3018"></a>


The html rendered by `AutoForm.Blazor.AutoControl` for models of type `MyModel` will now look something like this:

![Missing Image](https://static.rhomicro.com/files/images/github/autoform/10.png)


---
### Complex Models <a name="7028f0e0-7f29-43ae-a590-e8694852f927"></a>



Models require all their marked properties to be assignable to a control. 
    This means thet composite models will require all their submodels to also be marked for control generation. 
    Note that this model requires a subcontrol for its `NestedModel` property. 
    Luckily, its type has already been marked as a model. Had it not been, the generator would have issued an error.

```cs
using AutoForm.Attributes;

namespace TestApp.Models;

public sealed class ComplexModel
{
	[ModelProperty]
	public String? Street {
		get; set;
	}
	[ModelProperty]
	public String? City {
		get; set;
	}
	[ModelProperty]
	public Int32 ZipCode {
		get; set;
	}
	[ModelProperty]
	public String? Address {
		get; set;
	}
	[ModelProperty]
	public MyModel NestedModel { get; set; } = new MyModel();
}

```

*Source: [TestApp.Models.ComplexModel.cs](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Models/ComplexModel.cs)*



---
### Complex Models Result <a name="9e3aa67a-6423-47e4-a347-67c6a086f187"></a>


The html rendered by `AutoForm.Blazor.AutoControl` for models of type `ComplexModel` will now look something like this:

![Missing Image](https://static.rhomicro.com/files/images/github/autoform/20.png)


---
### Submodels <a name="bc589980-4078-4287-ae2e-4e3c69bea409"></a>



Models may inherit their base types model properties. Annotating a model with the `SubModelAttribute` will instruct the generator to enhance the generated control with subcontrols for properties found in the basetype.

```cs
using AutoForm.Attributes;

namespace TestApp.Models;

//Inherit subcontrols for all properties of MyModel
[SubModel(typeof(MyModel))]
//Inherit subcontrols for specific properties in MyModel
[SubModel(typeof(MyModel), nameof(MyModel.Name))]
public class SubModel : MyModel
{
	[ModelProperty]
	public Int32 Age {
		get; set;
	}
}

```

*Source: [TestApp.Models.SubModel.cs](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Models/SubModel.cs)*



For this model, labeled subcontrols are created using templates:

```cs
using AutoForm.Attributes;

namespace TestApp.Templates.SubModel;

[DefaultTemplate(typeof(Models.SubModel), nameof(Models.SubModel.Name))]
public sealed class NameTemplate : MyTemplate<String>
{
	public override IEnumerable<KeyValuePair<String, Object>>? Attributes {
		get; set;
	}
		= new Dictionary<String, Object>()
		{
				{"label", nameof(Models.SubModel.Name) }
		};
}

```

*Source: [TestApp.Templates.SubModel.NameTemplate.cs](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Templates/SubModel/NameTemplate.cs)*





```cs
using AutoForm.Attributes;

namespace TestApp.Templates.SubModel;

[DefaultTemplate(typeof(Models.SubModel), nameof(Models.SubModel.Age))]
public sealed class AgeTemplate : MyTemplate<Int32>
{
	public override IEnumerable<KeyValuePair<String, Object>>? Attributes {
		get; set;
	}
		= new Dictionary<String, Object>()
		{
				{"label", nameof(Models.SubModel.Age) }
		};
}

```

*Source: [TestApp.Templates.SubModel.AgeTemplate.cs](https://github.com/PaulBraetz/AutoForm/blob/master/TestApp/Templates/SubModel/AgeTemplate.cs)*



---
### Submodels Result <a name="1b5c2d91-9cfd-4b61-9b8e-3abeefb39bc5"></a>


The html rendered by `AutoForm.Blazor.AutoControl` for models of type `SubModel` will now look something like this:

![Missing Image](https://static.rhomicro.com/files/images/github/autoform/40.png)

---
## Planned Features <a name="7421ddb1-24e5-4737-a977-ee6149f2b05f"></a>


* Importing/Exporting types from and to other assemblies


---
## License <a name="c3ec6b49-3ec4-4287-bfc0-102a6f23d215"></a>

This software is licensed to you under the [MIT](LICENSE) license.


---
## Contributors <a name="dbdf899c-da5e-4a1c-bb23-c52884230777"></a>

* [Paul Brätz](https://github.com/PaulBraetz/ "Go to Profile")
